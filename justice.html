<!doctype html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Email Justice for George Floyd">
    <meta name="author" content="">

    <title>Justice for George Floyd</title>

    <!-- Bootstrap Core CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" rel="stylesheet">
</head>

<style>
    body {
        background-color: #222;
        color: #ccc;
    }

    .bg-dark {
        background-color: #111 !important;
        color: #ccc;
    }

    html {
        position: relative;
        min-height: 100%;
    }

    body {
          margin-bottom: 120px; /* Margin bottom by footer height */
    }

    .footer {
        position: absolute;
        bottom: 0;
        width: 100%;
        height: 120px; /* Set the fixed height of the footer here */
        background-color: #111;
    }
</style>

<body>
    <main>
        <!-- Navigation -->
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark static-top">
            <div class="container">
                <a class="navbar-brand" href="#">Justice for George Floyd</a>
            </div>
        </nav>

        <div class="container">
            <div class="row">
                <div class="col-lg-12 mt-5">
                    <p> This form calls for George Floyd's murderers to be arrested and brought to justice. It will send an email to the heads of the Minneapolis Police Department.
                        Please fill it out, send, and spread the word. #JusticeForFloyd #BlackLivesMatter </p>
                    <div class="form-group">
                        <label for="name">Name</label>
                        <input type="text"
                            class="form-control" id="nameInput"
                            aria-describedby="nameHelp" placeholder="First and Last"
                            onkeyup="updateMailto()">
                    </div>
                    <div class="form-group">
                        <label for="city">City</label>
                        <input type="text"
                            class="form-control" id="cityInput"
                            aria-describedby="city" placeholder="City"
                            onkeyup="updateMailto()">
                    </div>
                    <div class="form-group">
                        <label for="state">State</label>
                        <input type="text"
                            class="form-control" id="stateInput"
                            aria-describedby="city" placeholder="State"
                            onkeyup="updateMailto()">
                    </div>
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="checkbox" onchange="updateSubmitButton()">
                        <label class="form-check-label" for="checkbox">I have read the conditions below*.</label>
                    </div>
                    <a id="submitButton"
                        class="btn btn-primary mt-2 disabled" href="#"
                        role="button" aria-disabled="true">
                        Submit
                    </a>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container text-muted small">
            *This does not send an email on your behalf. This page composes an email for you, and will open your mail with a pre-filled email that you may modify before sending. This does not collect or store information.
        </div>
    </footer>

    <script>
        function updateSubmitButton() {
            const submitButton = document.getElementById("submitButton")
            const isAllowed = document.getElementById("checkbox").checked

            let classes = "btn btn-primary mt-2"

            if ( ! isAllowed ) classes += " disabled"

            submitButton.removeAttribute("class")
            submitButton.setAttribute("class", classes)
            submitButton.setAttribute("aria-disabled", ! isAllowed)
        }

        function updateMailto() {
            const submitButton = document.getElementById("submitButton")

            const name = document.getElementById("nameInput").value
            const city = document.getElementById("cityInput").value
            const state = document.getElementById("stateInput").value
            const isAllowed = document.getElementById("checkbox").checked

            // Only do the href if we are allowed to
            const mailto = getMailto(name, city, state)

            submitButton.setAttribute('href', mailto)
        }

        function getMailto(name, city, state) {
            const body =
            `Hello,

REWORKING EMAIL.

            const mailTo = "mailto:police@minneaopolisnmn.gov"
            const encodedSubject = '?subject=' + encodeURI("Justice for George Floyd")
            const encodedBody = '&body=' + encodeURI(body)
            const cc = "&cc=info@mpdfederation.com,citizeninfo@hennepin.us,minneapolis311@minneapolismn.gov"

            return mailTo + encodedSubject + encodedBody + cc
        }
    </script>
</body>

</html>
